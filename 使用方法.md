# 部署別進捗状況自動割当システム - 使用方法

## 概要
このシステムは、CSVファイルをインポートして部署別の進捗状況を分析し、CSV形式とPowerPoint形式でエクスポートするWebアプリケーションです。

## 機能
- **CSVファイルインポート**: ドラッグ&ドロップまたはファイル選択でCSVをアップロード
- **データプレビュー**: アップロードしたデータの内容を確認
- **部署別進捗状況分析**: 自動的に進捗状況を分類し、部署別に集計
- **CSVエクスポート**: 処理結果をCSV形式でダウンロード
- **PowerPointレポート生成**: 分析結果をPowerPoint形式で自動生成
- **デバッグ機能**: コンソールログで詳細な処理状況を確認
- **集計機能**: 開発対象と開発検討の小計、総計を表示

## 使用方法

### 1. CSVファイルの準備
以下の列を含むCSVファイルを準備してください：
- `部署`: タスクの担当部署
- `進捗状況`: タスクの現在の進捗状況
- `月工数（h）`: 月間工数（時間）
- `収益インパクト(月の工数＊単価)`: 収益インパクト（円）

### 2. システムの起動
1. `start_system.bat` をダブルクリックして実行
2. または `python server.py` を実行
3. ブラウザで `http://localhost:5000` にアクセス

### 3. ファイルのアップロード
1. アップロードエリアにCSVファイルをドラッグ&ドロップ、または「ファイルを選択」ボタンをクリック
2. ファイルが正常に読み込まれると、自動的にデータ処理が実行されます
3. 処理完了後、データプレビューと分析結果が同時に表示されます

### 4. データの確認
1. プレビューでデータ内容を確認
2. 処理結果で以下の情報が確認できます：
   - 処理部署数
   - 総タスク数
   - 完了率
3. 必要に応じて「データを再処理」ボタンで再実行可能

### 5. ファイルのダウンロード
データ処理が完了すると、以下の3種類のファイルをダウンロードできます：

#### 部署別進捗状況CSV
各部署の進捗状況を集計したデータ：
- 部署名
- 総タスク数
- 各進捗状況別のタスク数（リリース済み、リリース準備中、開発中、検討、中断、保留）
- 開発対象_小計（リリース済み + リリース準備中 + 開発中）
- 開発検討_小計（検討 + 中断 + 保留）
- 完了率
- 総月工数
- 総収益インパクト
- 総計行

**注意**: 「未着手」「未確認」のタスクは除外されます。

#### 処理済みデータCSV
元のデータに進捗カテゴリを追加したデータ：
- 元の全列
- 進捗カテゴリ（自動分類された進捗状況）

**注意**: 「未着手」「未確認」のタスクは除外されます。

#### PowerPointレポート
分析結果をPowerPoint形式で自動生成：
- 部署別進捗状況の表
- 見やすいレイアウトとスタイリング
- 自動的な色分けとフォーマット

**注意**: PowerPoint生成時のみ、集計データがサーバーに送信されます。

## 進捗状況の分類ルール
システムは以下のルールで進捗状況を自動分類します：

### 開発対象カテゴリ
- **リリース済み**: 「完了」「完成」「終了」「リリース済み」「公開済み」を含む
- **リリース準備中**: 「FB待ち」「公開可能」「公開済み（アップデート予定）」「川島さんに確認待ち」を含む
- **開発中**: 「実装」「設計」「進行中」「作業中」「実施中」を含む

### 開発検討カテゴリ
- **検討**: 「検討中」「検討」「計画中」「推奨（宮川案）」を含む
- **保留**: 「保留」「一時停止」「停止」を含む
- **中断**: 「中断」「中止」「キャンセル」を含む

### 除外対象
- **未着手・未確認**: 「未着手」「未確認」を含む（エクスポートから除外）

## 集計機能

### 開発対象_小計
リリース済み + リリース準備中 + 開発中の合計

### 開発検討_小計
検討 + 中断 + 保留の合計

### 総計
全部署の合計値（CSVエクスポートに含まれる）

## エクスポート除外項目
- **未着手・未確認タスク**: 進捗状況が「未着手」「未確認」のタスクは、エクスポートされるCSVファイルから除外されます
- **表示**: 画面上のテーブルには除外対象の列は表示されません
- **集計**: 除外対象のタスクは集計に含まれません

## デバッグ機能

### コンソールログの確認
1. ブラウザでF12キーを押して開発者ツールを開く
2. 「Console」タブを選択
3. システムの動作状況が詳細にログ出力されます

### ログの内容
- システム初期化状況
- ファイル読み込み状況
- データ処理状況
- CSV変換状況
- エラー詳細
- 除外対象タスク除外状況

## 対応ブラウザ
- Chrome (推奨)
- Firefox
- Safari
- Edge

## 注意事項
- ファイルサイズは10MB以下を推奨
- CSVファイルの文字エンコーディングはUTF-8を推奨
- CSVデータはブラウザ内で処理され、外部に送信されません
- PowerPoint生成時のみ、集計データがサーバーに送信されます
- 大量のデータを処理する場合は、処理に時間がかかる場合があります
- 「未着手」「未確認」のタスクはエクスポートから除外されます
- Python環境が必要です（python-pptx、flask等のライブラリ）

## トラブルシューティング

### ファイルが読み込めない場合
- ファイルがCSV形式であることを確認
- ファイルが破損していないことを確認
- ファイルサイズが大きすぎないことを確認
- ブラウザのコンソールでエラーメッセージを確認

### データが正しく表示されない場合
- CSVファイルの列名が正しいことを確認
- データに空の行や不正な文字が含まれていないことを確認
- 必須列（部署、進捗状況、月工数、収益インパクト）が含まれていることを確認

### エクスポートができない場合
- ブラウザのダウンロード設定を確認
- ポップアップブロッカーを無効化
- 十分なディスク容量があることを確認
- データを先に処理してからエクスポートを実行
- ブラウザのコンソールでエラーメッセージを確認

### よくあるエラーと対処法

#### 「エクスポートするデータがありません」エラー
- データを先に処理してからエクスポートを実行してください
- 「部署別進捗状況をエクスポート」ボタンをクリックしてデータを処理

#### 「CSVファイルの解析中にエラーが発生しました」エラー
- CSVファイルの形式を確認
- 文字エンコーディングがUTF-8であることを確認
- ファイルが破損していないことを確認

#### 「ファイルのダウンロードに失敗しました」エラー
- ブラウザのダウンロード設定を確認
- 別のブラウザで試行
- 十分なディスク容量があることを確認

### テスト用データ
`test_data.csv` ファイルが用意されています。このファイルを使用してシステムの動作を確認できます。

### 環境チェック
`check_environment.ps1` スクリプトを実行して、Python環境と必要なライブラリが正しくインストールされているか確認できます。

## サポート
問題が解決しない場合は、ブラウザのコンソールログを確認し、エラーメッセージを記録してからサポートに連絡してください。 

## 📊 エクスポート機能

### 1. 部署別進捗状況CSV
- **機能**: 部署別に集計された進捗状況データをCSV形式でダウンロード
- **内容**: 部署名、タスク数、各進捗状況の件数、完了率、工数、収益インパクト
- **用途**: 部署別の進捗管理、報告書作成

### 2. 処理済みデータCSV
- **機能**: カテゴリ分類済みの全データをCSV形式でダウンロード
- **内容**: 元データに「進捗カテゴリ」列を追加した完全なデータ
- **用途**: 詳細分析、データ検証、他システムへの連携

### 3. デプロイ日順ソートCSV ⭐ **新機能**
- **機能**: デプロイ日時を基準にソートしたCSVをダウンロード
- **対応日付形式**: 
  - "July 1, 2025" (英語月名形式)
  - "2025-07-01" (ISO形式)
  - "01/07/2025" (日/月/年形式)
  - その他の一般的な日付形式
- **ソート順**: 古い日付から新しい日付の順（デプロイ日時が未設定のデータは最後に配置）
- **用途**: デプロイ計画の確認、リリーススケジュール管理、時系列分析

### 4. PowerPointレポート
- **機能**: 部署別進捗状況をPowerPoint形式で自動生成
- **内容**: 部署別集計表、グラフ、サマリー情報
- **用途**: 会議資料、プレゼンテーション、経営報告 